[{"role": "system", "content": ""}, {"role": "user", "content": "```\n    pipeline = [\n        {\"$unwind\": \"$contracts\"},\n        {\"$unwind\": \"$contracts.bills\"},\n        {\"$unwind\": \"$contracts.bills.payments\"},\n        {\"$match\": {\"contracts.bills.payments.fixed_total\": {\"$exists\": False},\n                    \"contracts.bills.payments.is_aborted\": False}},\n        {\"$group\": {\"_id\": \"$contracts.bills.payments.code\", \"count\": {\"$sum\": 1}}},\n        {\"$match\": {\"count\": {\"$gt\": 1}}}\n    ]\n```\nadd one condition:\nbills.is_aborted must be False"}, {"role": "assistant", "content": "To add the condition `bills.is_aborted` must be `False`, you can modify the `$match` stage in the pipeline as follows:\n\n```python\npipeline = [\n    {\"$unwind\": \"$contracts\"},\n    {\"$unwind\": \"$contracts.bills\"},\n    {\"$unwind\": \"$contracts.bills.payments\"},\n    {\"$match\": {\n        \"contracts.bills.payments.fixed_total\": {\"$exists\": False},\n        \"contracts.bills.payments.is_aborted\": False,\n        \"contracts.bills.is_aborted\": False\n    }},\n    {\"$group\": {\"_id\": \"$contracts.bills.payments.code\", \"count\": {\"$sum\": 1}}},\n    {\"$match\": {\"count\": {\"$gt\": 1}}}\n]\n```\n\nThis will ensure that only documents where `contracts.bills.is_aborted` is `False` are included in the pipeline."}]